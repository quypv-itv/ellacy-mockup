<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Students - APPLYLEAD</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .brand-red {
            background-color: #d82128;
        }
        .brand-red-light {
            background-color: #FEF2F2;
        }
        .text-brand-red {
            color: #d82128;
        }
        .border-brand-red {
            border-color: #d82128;
        }
        .hover\:bg-brand-red:hover {
            background-color: #d82128;
        }
    </style>
</head>
<body style="background-color: #F9F9F9;">
    <!-- Sidebar -->
    <aside class="fixed left-0 top-0 h-screen w-64 bg-white shadow-lg">
        <div class="p-6">
             <img src="../../ApplyLead_logo.png" alt="ApplyLead" class="h-9 mb-2">
            <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">Agent</span>
        </div>
        <nav class="mt">
            <a href="Agency-dashboard.html" class="flex items-center px-6 py-3 text-gray-700 hover:bg-gray-50">
                <i data-lucide="layout-dashboard" class="w-5 h-5 mr-3"></i>
                Dashboard
            </a>
            <a href="#" class="flex items-center px-6 py-3 text-white" style="background-color: #d82128;">
                <i data-lucide="users" class="w-5 h-5 mr-3"></i>
                My Students
            </a>
            <a href="Agent-Application.html" class="flex items-center px-6 py-3 text-gray-700 hover:bg-gray-50">
                <i data-lucide="file-text" class="w-5 h-5 mr-3"></i>
                Applications
            </a>
            <a href="Agency-tasks.html" class="flex items-center px-6 py-3 text-gray-700 hover:bg-gray-50">
                <i data-lucide="check-square" class="w-5 h-5 mr-3"></i>
                Tasks
            </a>
            <a href="Agency-scholarships.html" class="flex items-center px-6 py-3 text-gray-700 hover:bg-gray-50">
                <i data-lucide="graduation-cap" class="w-5 h-5 mr-3"></i>
                Scholarships
            </a>
            <a href="Agency-commission.html" class="flex items-center px-6 py-3 text-gray-700 hover:bg-gray-50">
                <i data-lucide="dollar-sign" class="w-5 h-5 mr-3"></i>
                Commissions
            </a>
            <a href="Agency-profile.html" class="flex items-center px-6 py-3 text-gray-700 hover:bg-gray-50">
                <i data-lucide="settings" class="w-5 h-5 mr-3"></i>
                Account Settings
            </a>
            <a href="Agency-messages.html" class="flex items-center px-6 py-3 text-gray-700 hover:bg-gray-50">
                <i data-lucide="message-circle" class="w-5 h-5 mr-3"></i>
                Messages
            </a>
            <a href="Agency-admin-management.html" class="flex items-center px-6 py-3 text-gray-700 hover:bg-gray-50">
                <i data-lucide="users-2" class="w-5 h-5 mr-3"></i>
                Team Management
            </a>
        </nav>
        <div class="mt-auto px-6 py-4 border-t border-gray-200">
            <p class="text-sm text-gray-600 text-center">© 2025 APPLYLEAD. All rights reserved.</p>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="ml-64">
        <!-- Top Bar -->
        <header class="h-16 bg-white shadow-sm flex items-center justify-between px-6">
            <h2 class="text-xl font-semibold text-gray-800">My Students</h2>
            <div class="flex items-center space-x-4">
                <button class="relative">
                    <i data-lucide="bell" class="w-6 h-6 text-gray-600"></i>
                    <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                </button>
                <!-- Profile Dropdown -->
                <div class="relative">
                    <button id="profile-menu" class="flex items-center space-x-2 p-2 hover:bg-gray-100 rounded-full">
                        <img src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=100&h=100&fit=crop" 
                             alt="Profile" 
                             class="w-8 h-8 rounded-full object-cover">
                    </button>
                    
                    <!-- Dropdown Menu -->
                    <div id="profile-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg py-1 z-50">
                        <a href="Agency-profile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            <i data-lucide="settings" class="w-4 h-4 inline-block mr-2"></i> Settings
                        </a>
                        <a href="#" onclick="handleLogout()" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            <i data-lucide="log-out" class="w-4 h-4 inline-block mr-2"></i> Logout
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <main class="p-6">
            <!-- Search and Filters -->
            <div class="mb-6 space-y-4">
                <div class="flex items-center justify-between">
                    <div class="relative flex-1 max-w-lg">
                        <i data-lucide="search" class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"></i>
                        <input type="text" 
                               placeholder="Search by student name or email" 
                               class="w-full pl-10 pr-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <button onclick="openAddStudentModal()" class="text-white px-4 py-2 rounded-xl transition-colors hover:opacity-90" style="background-color: #d82128;">
                        <i data-lucide="plus" class="w-5 h-5 inline-block mr-1"></i>
                        Add New Student
                    </button>
                </div>
                <div class="flex items-center space-x-4">
                    <select class="rounded-lg border border-gray-300 px-3 py-2 text-sm">
                        <option>All Status</option>
                        <option>Initial Advising</option>
                        <option>Application In Progress</option>
                        <option>Submitted to School</option>
                        <option>School Response</option>
                        <option>Offered Letter Issued</option>
                        <option>Committed to School</option>
                        <option>Visa Application</option>
                        <option>Pre-departure</option>
                        <option>Arrival</option>
                    </select>
                 
                    <select class="rounded-lg border border-gray-300 px-3 py-2 text-sm">
                        <option>All Countries</option>
                        <option>Canada</option>
                        <option>Viet Nam</option>
                        <option>Australia</option>
                    </select>
                    <select class="rounded-lg border border-gray-300 px-3 py-2 text-sm">
                        <option>All Intakes</option>
                        <option>Fall 2024</option>
                        <option>Spring 2025</option>
                        <option>Fall 2025</option>
                    </select>
                    <select id="agent-filter" class="rounded-lg border border-gray-300 px-3 py-2 text-sm">
                        <option value="all">All Agents</option>
                        <option value="john-smith">John Smith</option>
                        <option value="emily-davis">Emily Davis</option>
                        <option value="michael-chen">Michael Chen</option>
                    </select>
                    <select id="activity-filter" class="rounded-lg border border-gray-300 px-3 py-2 text-sm">
                        <option value="all">All Activity</option>
                        <option value="active">Active Students</option>
                        <option value="inactive">Inactive Students</option>
                    </select>
                    <!-- View Toggle Buttons -->
                    <div class="flex items-center space-x-2 ml-4">
                        <button id="table-view-btn" class="px-3 py-2 text-sm font-medium rounded-lg transition-colors" style="background-color: #d82128; color: white;">
                            <i data-lucide="list" class="w-4 h-4 inline-block mr-1"></i>
                            
                        </button>
                        <button id="board-view-btn" class="px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                            <i data-lucide="columns" class="w-4 h-4 inline-block mr-1"></i>
                            
                        </button>
                    </div>
                </div>
            </div>

            <!-- Table View -->
            <div id="table-view" class="block">
                <!-- Students Table -->
                <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Agent / Student Name</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">UID</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Email</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Source</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Program Interest</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Application Status</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Last Activity</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Progress</th>
                                <th class="px-6 py-4 text-right text-sm font-semibold text-gray-600">Actions</th>
                            </tr>
                        </thead>
                    <tbody class="divide-y divide-gray-100" id="students-table-body">
                        <!-- Agent Group 1: John Smith -->
                        <tr class="bg-gray-100 agent-group-header cursor-pointer hover:bg-gray-200" onclick="toggleAgentGroup('john-smith')">
                            <td class="px-6 py-3" colspan="9">
                                <div class="flex items-center">
                                    <i id="john-smith-icon" data-lucide="plus" class="w-4 h-4 mr-2 text-gray-600"></i>
                                    <span class="text-sm font-semibold text-gray-800">John Smith (2 students)</span>
                                </div>
                            </td>
                        </tr>
                        <!-- Student Row 1 - Under John Smith -->
                        <tr class="hover:bg-gray-50 student-row john-smith-students hidden">
                            <td class="px-6 py-4">
                                <div class="flex items-center pl-6">
                                    <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=40&h=40&fit=crop" 
                                         class="w-8 h-8 rounded-full mr-3">
                                    <span class="text-sm font-medium">Sarah Chen</span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <span class="text-sm font-mono text-gray-700">VNHN-S1001</span>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">sarah.chen@example.com</td>
                            <td class="px-6 py-4">
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                    FB Ads – JUL25
                                </span>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">Canada – Business</td>
                            <td class="px-6 py-4">
                                <div class="flex flex-col space-y-1">
                                    <div class="text-xs font-medium text-gray-700">Step 6: School Acceptance</div>
                                    <div class="flex items-center space-x-1">
                                        <div class="flex space-x-1">
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                        </div>
                                        <span class="text-xs text-gray-500 ml-2">6/9</span>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">
                                <div class="flex items-center space-x-2">
                                    <span>Uploaded transcript – 2 days ago</span>
                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        <div class="w-2 h-2 bg-green-400 rounded-full mr-1"></div>
                                        Active
                                    </span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="h-2 rounded-full" style="background-color: #d82128; width: 80%"></div>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-right">
                                <div class="flex items-center justify-end space-x-2">
                                    <button onclick="window.location.href='Agency-my-student-detail.html?student=Sarah Chen'" class="p-1 hover:opacity-80" style="color: #d82128;" title="View Details">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                        </svg>
                                    </button>
                                    <button onclick="deleteStudent('Sarah Chen', 'sarah.chen@example.com')" class="text-red-600 hover:text-red-800 p-1" title="Delete Student">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                        </svg>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <!-- Student Row 2 - Under John Smith -->
                        <tr class="hover:bg-gray-50 student-row john-smith-students hidden">
                            <td class="px-6 py-4">
                                <div class="flex items-center pl-6">
                                    <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop" 
                                         class="w-8 h-8 rounded-full mr-3">
                                    <span class="text-sm font-medium">Mike Wong</span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <span class="text-sm font-mono text-gray-700">VNHN-S1002</span>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">mike.wong@example.com</td>
                            <td class="px-6 py-4">
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                    Event HN 2025
                                </span>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">Australia – Engineering</td>
                            <td class="px-6 py-4">
                                <div class="flex items-center">
                                    <span class="text-sm text-gray-600 mr-2">60%</span>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="h-2 rounded-full" style="background-color: #d82128; width: 60%"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                        </div>
                                        <span class="text-xs text-gray-500 ml-2">2/9</span>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">
                                <div class="flex items-center space-x-2">
                                    <span>Updated profile – 5 days ago</span>
                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                        <div class="w-2 h-2 bg-yellow-400 rounded-full mr-1"></div>
                                        Inactive
                                    </span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="h-2 rounded-full" style="background-color: #d82128; width: 60%"></div>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-right">
                                <div class="flex items-center justify-end space-x-2">
                                    <button onclick="window.location.href='Agency-my-student-detail.html?student=mike-wong'" class="p-1 hover:opacity-80" style="color: #d82128;" title="View Details">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                        </svg>
                                    </button>
                                    <button onclick="deleteStudent('Mike Wong', 'mike.wong@example.com')" class="text-red-600 hover:text-red-800 p-1" title="Delete Student">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                        </svg>
                                    </button>
                                </div>
                            </td>
                        </tr>

                        <!-- Agent Group 2: Emily Davis -->
                        <tr class="bg-gray-100 agent-group-header cursor-pointer hover:bg-gray-200" onclick="toggleAgentGroup('emily-davis')">
                            <td class="px-6 py-3" colspan="9">
                                <div class="flex items-center">
                                    <i id="emily-davis-icon" data-lucide="plus" class="w-4 h-4 mr-2 text-gray-600"></i>
                                    <span class="text-sm font-semibold text-gray-800">Emily Davis (1 student)</span>
                                </div>
                            </td>
                        </tr>
                        <!-- Student Row 3 - Under Emily Davis -->
                        <tr class="hover:bg-gray-50 student-row emily-davis-students hidden">
                            <td class="px-6 py-4">
                                <div class="flex items-center pl-6">
                                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop" 
                                         class="w-8 h-8 rounded-full mr-3">
                                    <span class="text-sm font-medium">David Kim</span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <span class="text-sm font-mono text-gray-700">VNHN-S1003</span>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">david.kim@example.com</td>
                            <td class="px-6 py-4">
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                                    Partner ABC
                                </span>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">UK – Medicine</td>
                            <td class="px-6 py-4">
                                <div class="flex flex-col space-y-1">
                                    <div class="text-xs font-medium text-gray-700">Step 4: Application Prep</div>
                                    <div class="flex items-center space-x-1">
                                        <div class="flex space-x-1">
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full" style="background-color: #d82128;"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                        </div>
                                        <span class="text-xs text-gray-500 ml-2">4/9</span>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-600">
                                <div class="flex items-center space-x-2">
                                    <span>Submitted documents – 1 day ago</span>
                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        <div class="w-2 h-2 bg-green-400 rounded-full mr-1"></div>
                                        Active
                                    </span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="h-2 rounded-full" style="background-color: #d82128; width: 45%"></div>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-right">
                                <div class="flex items-center justify-end space-x-2">
                                    <button onclick="window.location.href='Agency-my-student-detail.html?student=emma-davis'" class="p-1 hover:opacity-80" style="color: #d82128;" title="View Details">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                        </svg>
                                    </button>
                                    <button onclick="deleteStudent('David Kim', 'david.kim@example.com')" class="text-red-600 hover:text-red-800 p-1" title="Delete Student">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                        </svg>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                    </table>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="board-view" class="hidden">
                <div class="overflow-x-auto">
                    <div class="flex space-x-4 min-w-max pb-4">
                        <!-- Step 1: Initial Advising -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">Initial Advising</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">2</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96">
                                    <!-- Student Card -->
                                    <div class="bg-gray-50 rounded-xl p-3 border border-gray-200 hover:shadow-md transition-shadow cursor-move" draggable="true" data-student-id="1" data-step="1">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center space-x-3">
                                                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop" class="w-8 h-8 rounded-full">
                                                <div class="flex-1">
                                                    <div class="font-medium text-sm text-gray-900">John Smith</div>
                                                    <div class="text-xs text-gray-500">USA – Computer Science</div>
                                                </div>
                                            </div>
                                            <span class="text-xs px-2 py-1 rounded-full text-white" style="background-color: #3B82F6;">John Smith</span>
                                        </div>
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="text-xs text-gray-500">Last activity: 1 day ago</div>
                                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                <div class="w-2 h-2 bg-green-400 rounded-full mr-1"></div>
                                                Active
                                            </span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="flex space-x-1">
                                                <button class="text-xs px-2 py-1 rounded" style="background-color: #FEF2F2; color: #d82128;" title="Send Message">
                                                    <i data-lucide="message-circle" class="w-3 h-3"></i>
                                                </button>
                                                <button onclick="window.location.href='Agency-my-student-detail.html?student=sarah-johnson'" class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200" title="View Details">
                                                    <i data-lucide="eye" class="w-3 h-3"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Another Student Card -->
                                    <div class="bg-gray-50 rounded-xl p-3 border border-gray-200 hover:shadow-md transition-shadow cursor-move" draggable="true" data-student-id="2" data-step="1">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center space-x-3">
                                                <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop" class="w-8 h-8 rounded-full">
                                                <div class="flex-1">
                                                    <div class="font-medium text-sm text-gray-900">Lisa Wang</div>
                                                    <div class="text-xs text-gray-500">Canada – Business</div>
                                                </div>
                                            </div>
                                            <span class="text-xs px-2 py-1 rounded-full text-white" style="background-color: #10B981;">Emily Davis</span>
                                        </div>
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="text-xs text-gray-500">Last activity: 3 days ago</div>
                                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                                <div class="w-2 h-2 bg-yellow-400 rounded-full mr-1"></div>
                                                Inactive
                                            </span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="flex space-x-1">
                                                <button class="text-xs px-2 py-1 rounded" style="background-color: #FEF2F2; color: #d82128;" title="Send Message">
                                                    <i data-lucide="message-circle" class="w-3 h-3"></i>
                                                </button>
                                                <button onclick="window.location.href='Agency-my-student-detail.html?student=sarah-johnson'" class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200" title="View Details">
                                                    <i data-lucide="eye" class="w-3 h-3"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: Application In Progress -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">Application In Progress</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">1</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96 drop-zone" data-step="2">
                                    <!-- Student Card -->
                                    <div class="bg-gray-50 rounded-xl p-3 border border-gray-200 hover:shadow-md transition-shadow cursor-move" draggable="true" data-student-id="3" data-step="2">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center space-x-3">
                                                <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop" class="w-8 h-8 rounded-full">
                                                <div class="flex-1">
                                                    <div class="font-medium text-sm text-gray-900">Mike Wong</div>
                                                    <div class="text-xs text-gray-500">Australia – Engineering</div>
                                                </div>
                                            </div>
                                            <span class="text-xs px-2 py-1 rounded-full text-white" style="background-color: #3B82F6;">John Smith</span>
                                        </div>
                                        <div class="text-xs text-gray-500 mb-2">Last activity: 5 days ago</div>
                                        <div class="flex items-center justify-between">
                                            <div class="flex space-x-1">
                                                <button class="text-xs px-2 py-1 rounded" style="background-color: #FEF2F2; color: #d82128;" title="Send Message">
                                                    <i data-lucide="message-circle" class="w-3 h-3"></i>
                                                </button>
                                                <button onclick="window.location.href='Agency-my-student-detail.html?student=sarah-johnson'" class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200" title="View Details">
                                                    <i data-lucide="eye" class="w-3 h-3"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3: Submitted to School -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">Submitted to School</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">1</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96 drop-zone" data-step="3">
                                    <div class="text-center text-gray-400 text-sm mt-20">
                                        No students at this stage
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4: School Response -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">School Response</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">0</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96 drop-zone" data-step="4">
                                    <div class="text-center text-gray-400 text-sm mt-20">
                                        No students at this stage
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 5: Offered Letter Issued -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">Offered Letter Issued</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">0</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96 drop-zone" data-step="5">
                                    <div class="text-center text-gray-400 text-sm mt-20">
                                        No students at this stage
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 6: Committed to School -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">Committed to School</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">0</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96 drop-zone" data-step="6">
                                    <!-- Student Card -->
                                    <div class="bg-gray-50 rounded-xl p-3 border border-gray-200 hover:shadow-md transition-shadow cursor-move" draggable="true" data-student-id="4" data-step="6">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center space-x-3">
                                                <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=40&h=40&fit=crop" class="w-8 h-8 rounded-full">
                                                <div class="flex-1">
                                                    <div class="font-medium text-sm text-gray-900">Sarah Chen</div>
                                                    <div class="text-xs text-gray-500">Canada – Business</div>
                                                </div>
                                            </div>
                                            <span class="text-xs px-2 py-1 rounded-full text-white" style="background-color: #3B82F6;">John Smith</span>
                                        </div>
                                        <div class="text-xs text-gray-500 mb-2">Last activity: 2 days ago</div>
                                        <div class="flex items-center justify-between">
                                            <div class="flex space-x-1">
                                                <button class="text-xs px-2 py-1 rounded" style="background-color: #FEF2F2; color: #d82128;" title="Send Message">
                                                    <i data-lucide="message-circle" class="w-3 h-3"></i>
                                                </button>
                                                <button onclick="window.location.href='Agency-my-student-detail.html?student=sarah-johnson'" class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200" title="View Details">
                                                    <i data-lucide="eye" class="w-3 h-3"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 7: Visa Application -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">Visa Application</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">0</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96 drop-zone" data-step="7">
                                    <div class="text-center text-gray-400 text-sm mt-20">
                                        No students at this stage
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 8: Pre-departure -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">Pre-departure</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">0</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96 drop-zone" data-step="8">
                                    <div class="text-center text-gray-400 text-sm mt-20">
                                        No students at this stage
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 9: Arrival -->
                        <div class="flex-shrink-0 w-72">
                            <div class="bg-white rounded-2xl shadow-sm">
                                <div class="p-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-gray-900">Arrival</h3>
                                        <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full">0</span>
                                    </div>
                                </div>
                                <div class="p-4 space-y-3 min-h-96 drop-zone" data-step="9">
                                    <div class="text-center text-gray-400 text-sm mt-20">
                                        No students at this stage
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- AI Assistant Floating Button -->
    <div id="ai-assistant" class="fixed bottom-6 right-6 z-50">
        <!-- Floating Button -->
        <button id="ai-chat-toggle" class="w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 hover:scale-110" style="background-color: #d82128;">
            <i data-lucide="message-circle" class="w-6 h-6 text-white"></i>
        </button>
        
        <!-- Chat Panel -->
        <div id="ai-chat-panel" class="hidden absolute bottom-16 right-0 w-80 h-96 bg-white rounded-2xl shadow-2xl border border-gray-200 flex flex-col">
            <!-- Chat Header -->
            <div class="flex items-center justify-between p-4 border-b border-gray-200 rounded-t-2xl" style="background-color: #FEF2F2;">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 rounded-full flex items-center justify-center" style="background-color: #d82128;">
                        <i data-lucide="bot" class="w-4 h-4 text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-900">AI Assistant</h3>
                        <div class="flex items-center space-x-1">
                            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                            <span class="text-xs text-gray-500">Online</span>
                        </div>
                    </div>
                </div>
                <button id="ai-chat-close" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            
            <!-- Chat Messages -->
            <div class="flex-1 p-4 overflow-y-auto space-y-3">
                <!-- AI Message -->
                <div class="flex items-start space-x-2">
                    <div class="w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0" style="background-color: #FEF2F2;">
                        <i data-lucide="bot" class="w-3 h-3" style="color: #d82128;"></i>
                    </div>
                    <div class="bg-gray-100 rounded-2xl px-3 py-2 max-w-xs">
                        <p class="text-sm text-gray-800">Hello! I can help you manage your students and track their progress. What would you like to know?</p>
                    </div>
                </div>
                
                <!-- User Message Example -->
                <div class="flex items-start space-x-2 justify-end">
                    <div class="rounded-2xl px-3 py-2 max-w-xs" style="background-color: #d82128;">
                        <p class="text-sm text-white">Show me students with missing documents</p>
                    </div>
                </div>
            </div>
            
            <!-- Chat Input -->
            <div class="p-4 border-t border-gray-200">
                <div class="flex items-center space-x-2">
                    <input type="text" placeholder="Type your message..." class="flex-1 px-3 py-2 border border-gray-300 rounded-full text-sm focus:outline-none focus:ring-2" style="--tw-ring-color: #d82128;">
                    <button class="w-8 h-8 rounded-full flex items-center justify-center" style="background-color: #d82128;">
                        <i data-lucide="send" class="w-4 h-4 text-white"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Details Modal -->
    <div id="student-details-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
        <div class="bg-white rounded-3xl w-full max-w-3xl max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold">Student Details</h3>
                    <button onclick="closeStudentDetailsModal()" class="text-gray-400 hover:text-gray-600">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <!-- Profile Summary -->
                <div class="mb-6">
                    <h4 class="text-lg font-medium mb-4">Profile Summary</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <p class="text-sm text-gray-500">Full Name</p>
                            <p class="font-medium">Sarah Chen</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Email</p>
                            <p class="font-medium">sarah.chen@example.com</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Phone</p>
                            <p class="font-medium">+1 234 567 8900</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Country of Origin</p>
                            <p class="font-medium">China</p>
                        </div>
                    </div>
                </div>

                <!-- Application History -->
                <div class="mb-6">
                    <h4 class="text-lg font-medium mb-4">Application History</h4>
                    <div class="space-y-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0">
                                <i data-lucide="check" class="w-4 h-4 text-green-600"></i>
                            </div>
                            <div>
                                <p class="text-sm font-medium">Application Accepted</p>
                                <p class="text-xs text-gray-500">University of Toronto - Business Administration</p>
                                <p class="text-xs text-gray-400">2 days ago</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0">
                                <i data-lucide="file" class="w-4 h-4 text-blue-600"></i>
                            </div>
                            <div>
                                <p class="text-sm font-medium">Documents Uploaded</p>
                                <p class="text-xs text-gray-500">Transcript and Language Test Results</p>
                                <p class="text-xs text-gray-400">1 week ago</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Assigned Agent -->
                <div class="mb-6">
                    <h4 class="text-lg font-medium mb-4">Assigned Agent Member</h4>
                    <div class="flex items-center space-x-3">
                        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop" 
                             alt="Agent Profile" 
                             class="w-10 h-10 rounded-full object-cover">
                        <div>
                            <p class="text-sm font-medium">John Smith</p>
                            <p class="text-xs text-gray-500">Senior Education Consultant</p>
                        </div>
                    </div>
                </div>

                <!-- Missing Documents -->
                <div class="mb-6">
                    <h4 class="text-lg font-medium mb-4">Missing Documents</h4>
                    <ul class="space-y-2">
                        <li class="flex items-center text-sm text-gray-600">
                            <i data-lucide="alert-circle" class="w-4 h-4 text-yellow-500 mr-2"></i>
                            Passport Copy
                        </li>
                        <li class="flex items-center text-sm text-gray-600">
                            <i data-lucide="alert-circle" class="w-4 h-4 text-yellow-500 mr-2"></i>
                            Financial Statement
                        </li>
                    </ul>
                </div>

                <!-- Actions -->
                <div class="flex justify-end space-x-4">
                    <button class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg">
                        Send Reminder
                    </button>
                    <button class="px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors hover:opacity-90" style="background-color: #d82128;">
                        Open in Application Manager
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add New Student Modal -->
    <div id="add-student-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
        <div class="relative top-20 mx-auto p-8 border-0 w-[600px] shadow-xl rounded-3xl bg-white">
            <!-- Email validation error -->
            <div id="email-error" class="hidden absolute -top-16 left-0 right-0 mx-auto w-fit bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-lg">
                This email is already registered in the system.
            </div>
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold text-gray-900">Add New Student</h3>
                <button onclick="closeAddStudentModal()" class="text-gray-400 hover:text-gray-500">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>

            <form id="add-student-form" class="space-y-6" onsubmit="handleAddStudent(event)" novalidate>
                <!-- Basic Information -->
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Heard Us From *</label>
                        <div class="relative">
                            <select name="heardFrom" required
                                    class="w-full px-3 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none">
                                <option value="">Select how you heard about us</option>
                                <option value="social_media">Social Media</option>
                                <option value="referral">Friend/Family Referral</option>
                                <option value="search">Search Engine</option>
                                <option value="education_fair">Education Fair</option>
                                <option value="partner_school">Partner School</option>
                                <option value="advertisement">Advertisement</option>
                                <option value="other">Other</option>
                            </select>
                            <i data-lucide="megaphone" class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"></i>
                            <i data-lucide="chevron-down" class="w-5 h-5 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2"></i>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Full Name *</label>
                        <input type="text" name="fullName" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2" style="--tw-ring-color: #d82128;">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email Address *</label>
                        <input type="email" name="email" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2" style="--tw-ring-color: #d82128;">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
                        <input type="tel" name="phone"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2" style="--tw-ring-color: #d82128;">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Country of Interest *</label>
                        <select name="country" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2" style="--tw-ring-color: #d82128;">
                            <option value="">Select a country</option>
                            <option value="usa">United States</option>
                            <option value="uk">United Kingdom</option>
                            <option value="canada">Canada</option>
                            <option value="australia">Australia</option>
                            <option value="newzealand">New Zealand</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Intended Field of Study *</label>
                        <input type="text" name="fieldOfStudy" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2" style="--tw-ring-color: #d82128;">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Intake Period *</label>
                        <select name="intakePeriod" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2" style="--tw-ring-color: #d82128;">
                            <option value="">Select intake period</option>
                            <option value="fall2025">Fall 2025</option>
                            <option value="spring2026">Spring 2026</option>
                            <option value="fall2026">Fall 2026</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Agent Name *</label>
                        <div class="relative">
                            <select name="Agent Name" required
                                    class="w-full px-3 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none">
                                <option value="">Select an agent</option>
                                <option value="john-smith">John Smith</option>
                                <option value="sarah-wilson">Sarah Wilson</option>
                                <option value="emily-davis">Emily Davis</option>
                                <option value="michael-lee">Michael Lee</option>
                                <option value="david-chen">David Chen</option>
                            </select>
                            <i data-lucide="user-check" class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"></i>
                            <i data-lucide="chevron-down" class="w-5 h-5 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2"></i>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Notes</label>
                        <textarea name="notes" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2" style="--tw-ring-color: #d82128;"></textarea>
                    </div>

                    <!-- Optional Section for Agent Admin -->
                    <div id="admin-section" class="hidden space-y-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <div class="flex items-center justify-between">
                            <h4 class="text-sm font-medium text-gray-900">Admin Options</h4>
                            <span class="text-xs text-gray-500">Only visible to admin users</span>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Assign to Staff Member</label>
                            <div class="relative">
                                <select name="assignedStaff" id="assignedStaff"
                                        class="w-full px-3 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 appearance-none" style="--tw-ring-color: #d82128;">
                                    <option value="">Select staff member</option>
                                    <option value="john" data-role="Senior Agent">John Smith</option>
                                    <option value="sarah" data-role="Education Consultant">Sarah Johnson</option>
                                    <option value="michael" data-role="Junior Agent">Michael Lee</option>
                                    <option value="emma" data-role="Senior Consultant">Emma Wilson</option>
                                </select>
                                <i data-lucide="users" class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"></i>
                                <i data-lucide="chevron-down" class="w-5 h-5 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2"></i>
                            </div>
                            <p id="selected-staff-info" class="hidden mt-2 text-xs text-gray-500"></p>
                        </div>

                        <div class="flex items-start space-x-2">
                            <input type="checkbox" id="notify-staff" name="notifyStaff"
                                   class="mt-1 rounded border-gray-300" style="color: #d82128; --tw-ring-color: #d82128;">
                            <label for="notify-staff" class="text-sm text-gray-600">
                                Send email notification to assigned staff member
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="closeAddStudentModal()"
                            class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg">
                        Cancel
                    </button>
                    <button type="submit"
                            class="px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors hover:opacity-90" style="background-color: #d82128;">
                        Save & Continue
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Student Details Modal -->
    <div id="student-details-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
        <div class="relative top-10 mx-auto p-8 border-0 w-[700px] shadow-xl rounded-3xl bg-white">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold text-gray-900">Student Details</h3>
                <button onclick="closeStudentDetailsModal()" class="text-gray-400 hover:text-gray-500">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            
            <!-- Student Info -->
            <div class="grid grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                    <p id="detail-student-name" class="text-sm text-gray-900 font-medium">-</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <p id="detail-student-email" class="text-sm text-gray-900">-</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                    <p id="detail-student-phone" class="text-sm text-gray-900">-</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Country</label>
                    <p id="detail-student-country" class="text-sm text-gray-900">-</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Program</label>
                    <p id="detail-student-program" class="text-sm text-gray-900">-</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Assigned Agent</label>
                    <p id="detail-student-agent" class="text-sm text-gray-900">-</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Current Step</label>
                    <p id="detail-student-step" class="text-sm text-gray-900">-</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Join Date</label>
                    <p id="detail-student-join-date" class="text-sm text-gray-900">-</p>
                </div>
            </div>

            <!-- Progress -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Application Progress</label>
                <div class="w-full bg-gray-200 rounded-full h-3">
                    <div id="detail-student-progress" class="h-3 rounded-full" style="background-color: #d82128; width: 0%"></div>
                </div>
                <p id="detail-student-progress-text" class="text-sm text-gray-600 mt-1">0%</p>
            </div>

            <!-- Notes -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                <p id="detail-student-notes" class="text-sm text-gray-700 bg-gray-50 p-3 rounded-lg">-</p>
            </div>

            <!-- Documents -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Documents</label>
                <ul id="detail-student-documents" class="space-y-2">
                    <!-- Documents will be populated by JavaScript -->
                </ul>
            </div>

            <!-- Actions -->
            <div class="flex justify-end space-x-4">
                <button onclick="closeStudentDetailsModal()" 
                        class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg">
                    Close
                </button>
                <button class="px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors hover:opacity-90" 
                        style="background-color: #d82128;">
                    Edit Student
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="hidden fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50">
        <span id="toast-message">Success!</span>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Agent Group Toggle Functionality
        function toggleAgentGroup(agentId) {
            const students = document.querySelectorAll(`.${agentId}-students`);
            const icon = document.getElementById(`${agentId}-icon`);
            const isHidden = students[0] && students[0].classList.contains('hidden');
            
            students.forEach(student => {
                if (isHidden) {
                    student.classList.remove('hidden');
                } else {
                    student.classList.add('hidden');
                }
            });
            
            // Toggle icon
            if (isHidden) {
                icon.setAttribute('data-lucide', 'minus');
            } else {
                icon.setAttribute('data-lucide', 'plus');
            }
            
            // Reinitialize icons
            lucide.createIcons();
        }

        // Agent Filter Functionality
    document.getElementById('agent-filter').addEventListener('change', function() {
        const selectedAgent = this.value;
        const allAgentGroups = document.querySelectorAll('.agent-group-header');
        const allStudentRows = document.querySelectorAll('.student-row');
        
        if (selectedAgent === 'all') {
            // Show all agent groups and their students
            allAgentGroups.forEach(group => group.style.display = 'table-row');
            allStudentRows.forEach(row => {
                // Keep the hidden/shown state based on group expansion
                row.style.display = 'table-row';
            });
        } else {
            // Hide all groups first
            allAgentGroups.forEach(group => group.style.display = 'none');
            allStudentRows.forEach(row => row.style.display = 'none');
            
            // Show only selected agent group and students
            const selectedGroup = document.querySelector(`[onclick="toggleAgentGroup('${selectedAgent}')"]`);
            const selectedStudents = document.querySelectorAll(`.${selectedAgent}-students`);
            
            if (selectedGroup) {
                selectedGroup.style.display = 'table-row';
                selectedStudents.forEach(student => {
                    student.style.display = 'table-row';
                    student.classList.remove('hidden'); // Auto-expand when filtering
                });
                
                // Update icon to minus (expanded)
                const icon = document.getElementById(`${selectedAgent}-icon`);
                if (icon) {
                    icon.setAttribute('data-lucide', 'minus');
                    lucide.createIcons();
                }
            }
        }
    });

        // Kanban Board Agent Filter
        function filterKanbanByAgent(agentId) {
            const allCards = document.querySelectorAll('[data-student-id]');
            
            allCards.forEach(card => {
                const agentBadge = card.querySelector('span[style*="background-color"]');
                if (agentBadge) {
                    const agentName = agentBadge.textContent.trim();
                    
                    if (agentId === 'all' || agentName.toLowerCase().replace(' ', '-') === agentId) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                }
            });
            
            // Update column counts after filtering
            if (typeof updateColumnCounts === 'function') {
                updateColumnCounts();
            }
        }

        // View Toggle Functionality
        const tableViewBtn = document.getElementById('table-view-btn');
        const boardViewBtn = document.getElementById('board-view-btn');
        const tableView = document.getElementById('table-view');
        const boardView = document.getElementById('board-view');

        // Initialize view toggle functionality
        if (tableViewBtn && boardViewBtn && tableView && boardView) {
            // Set initial state
            tableView.classList.remove('hidden');
            boardView.classList.add('hidden');
            tableViewBtn.style.backgroundColor = '#d82128';
            tableViewBtn.style.color = 'white';
            boardViewBtn.style.backgroundColor = '#F3F4F6';
            boardViewBtn.style.color = '#6B7280';

            // Load saved view preference
            const savedViewMode = localStorage.getItem('studentViewMode');
            if (savedViewMode === 'board') {
                boardViewBtn.click();
            }
        }

        tableViewBtn.addEventListener('click', () => {
            tableView.classList.remove('hidden');
            boardView.classList.add('hidden');
            tableViewBtn.style.backgroundColor = '#d82128';
            tableViewBtn.style.color = 'white';
            boardViewBtn.style.backgroundColor = '#F3F4F6';
            boardViewBtn.style.color = '#6B7280';
        });

        boardViewBtn.addEventListener('click', () => {
            tableView.classList.add('hidden');
            boardView.classList.remove('hidden');
            boardViewBtn.style.backgroundColor = '#d82128';
            boardViewBtn.style.color = 'white';
            tableViewBtn.style.backgroundColor = '#F3F4F6';
            tableViewBtn.style.color = '#6B7280';
        });

        const profileMenu = document.getElementById('profile-menu');
        const profileDropdown = document.getElementById('profile-dropdown');

        // AI Assistant Toggle
        const aiChatToggle = document.getElementById('ai-chat-toggle');
        const aiChatPanel = document.getElementById('ai-chat-panel');
        const aiChatClose = document.getElementById('ai-chat-close');

        if (aiChatToggle && aiChatPanel) {
            aiChatToggle.addEventListener('click', () => {
                aiChatPanel.classList.toggle('hidden');
            });
        }

        if (aiChatClose && aiChatPanel) {
            aiChatClose.addEventListener('click', () => {
                aiChatPanel.classList.add('hidden');
            });
        }

        // Modal functionality
        // Add New Student Modal Functions
        function openAddStudentModal() {
            const modal = document.getElementById('add-student-modal');
            if (modal) {
                modal.classList.remove('hidden');
            }
        }

        function closeAddStudentModal() {
            const modal = document.getElementById('add-student-modal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        // Student Details Modal Functions
        function openStudentDetailsModal(studentId) {
            const modal = document.getElementById('student-details-modal');
            if (modal) {
                // Load student data based on studentId
                loadStudentDetails(studentId);
                modal.classList.remove('hidden');
            }
        }

        function closeStudentDetailsModal() {
            const modal = document.getElementById('student-details-modal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        function loadStudentDetails(studentId) {
            // Sample student data - in real app, this would come from API
            const studentData = {
                'sarah-johnson': {
                    name: 'Sarah Johnson',
                    email: 'sarah.johnson@example.com',
                    phone: '+1 (555) 123-4567',
                    country: 'USA',
                    program: 'Computer Science',
                    agent: 'John Smith',
                    step: 'Initial Advising',
                    progress: 80,
                    joinDate: '2024-01-15',
                    notes: 'Interested in AI and Machine Learning programs. Has strong academic background.',
                    documents: ['Passport', 'Transcripts', 'IELTS Certificate']
                },
                'mike-wong': {
                    name: 'Mike Wong',
                    email: 'mike.wong@example.com',
                    phone: '+61 400 123 456',
                    country: 'Australia',
                    program: 'Engineering',
                    agent: 'John Smith',
                    step: 'Docs Review',
                    progress: 60,
                    joinDate: '2024-02-01',
                    notes: 'Engineering student with focus on renewable energy systems.',
                    documents: ['Passport', 'Academic Records']
                },
                'emma-davis': {
                    name: 'Emma Davis',
                    email: 'emma.davis@example.com',
                    phone: '+44 7700 900123',
                    country: 'UK',
                    program: 'Business Administration',
                    agent: 'Sarah Wilson',
                    step: 'Agreement & 1st Payment',
                    progress: 45,
                    joinDate: '2024-01-20',
                    notes: 'MBA candidate with 3 years work experience in finance.',
                    documents: ['Passport', 'Work Experience Letter', 'GMAT Scores']
                }
            };

            const student = studentData[studentId] || studentData['sarah-johnson'];
            
            // Update modal content
            document.getElementById('detail-student-name').textContent = student.name;
            document.getElementById('detail-student-email').textContent = student.email;
            document.getElementById('detail-student-phone').textContent = student.phone;
            document.getElementById('detail-student-country').textContent = student.country;
            document.getElementById('detail-student-program').textContent = student.program;
            document.getElementById('detail-student-agent').textContent = student.agent;
            document.getElementById('detail-student-step').textContent = student.step;
            document.getElementById('detail-student-progress').style.width = student.progress + '%';
            document.getElementById('detail-student-progress-text').textContent = student.progress + '%';
            document.getElementById('detail-student-join-date').textContent = student.joinDate;
            document.getElementById('detail-student-notes').textContent = student.notes;
            
            // Update documents list
            const docsList = document.getElementById('detail-student-documents');
            docsList.innerHTML = '';
            student.documents.forEach(doc => {
                const li = document.createElement('li');
                li.className = 'flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg';
                li.innerHTML = `
                    <span class="text-sm text-gray-700">${doc}</span>
                    <span class="text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full">✓ Uploaded</span>
                `;
                docsList.appendChild(li);
            });
        }

        const addStudentModal = document.getElementById('add-student-modal');
        const addStudentForm = document.getElementById('add-student-form');

        if (addStudentModal) {
            addStudentModal.addEventListener('click', (e) => {
                if (e.target === addStudentModal) {
                    closeAddStudentModal();
                }
            });
        }

        if (addStudentForm) {
            addStudentForm.addEventListener('submit', handleAddStudent);
        }

        // Student Details Modal event listeners
        const studentDetailsModal = document.getElementById('student-details-modal');
        if (studentDetailsModal) {
            studentDetailsModal.addEventListener('click', (e) => {
                if (e.target === studentDetailsModal) {
                    closeStudentDetailsModal();
                }
            });
        }

        function handleAddStudent(event) {
            event.preventDefault();
            const formData = new FormData(addStudentForm);
            const studentData = Object.fromEntries(formData);

            // Additional validation for required fields
            if (!studentData.heardFrom) {
                alert('Please select how you heard about us');
                return;
            }

            // Email validation (simulated backend check)
            if (studentData.email.toLowerCase() === 'test@example.com') {
                document.getElementById('email-error').classList.remove('hidden');
                return;
            }

            // Here you would typically send the data to your backend
            console.log('New student data:', studentData);

            // Hide any previous error messages
            document.getElementById('email-error').classList.add('hidden');

            // For demo purposes, we'll just show the success message
            closeAddStudentModal();
            showToast();

            // You would typically reload the student list or add the new student to the table
            // For now, we'll just reload the page after a short delay
            setTimeout(() => {
                window.location.reload();
            }, 3000);
        }

        // Staff selection handling
        const assignedStaffSelect = document.getElementById('assignedStaff');
        const selectedStaffInfo = document.getElementById('selected-staff-info');

        assignedStaffSelect.addEventListener('change', (e) => {
            const selectedOption = e.target.options[e.target.selectedIndex];
            const role = selectedOption.getAttribute('data-role');
            const staffName = selectedOption.text;
            
            if (e.target.value) {
                selectedStaffInfo.textContent = `${staffName} - ${role}`;
                selectedStaffInfo.classList.remove('hidden');
            } else {
                selectedStaffInfo.classList.add('hidden');
            }
        });

        // Profile dropdown functionality
        if (profileMenu && profileDropdown) {
            profileMenu.addEventListener('click', () => {
                profileDropdown.classList.toggle('hidden');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!profileMenu.contains(e.target) && !profileDropdown.contains(e.target)) {
                    profileDropdown.classList.add('hidden');
                }
            });
        }

        // Drag and Drop Functionality
        let draggedElement = null;
        let draggedStudentId = null;
        let draggedFromStep = null;

        // Add drag event listeners to all student cards
        function initializeDragAndDrop() {
            document.querySelectorAll('[draggable="true"]').forEach(card => {
                card.addEventListener('dragstart', (e) => {
                    draggedElement = e.target;
                    draggedStudentId = e.target.getAttribute('data-student-id');
                    draggedFromStep = parseInt(e.target.getAttribute('data-step'));
                    e.target.style.opacity = '0.5';
                });

                card.addEventListener('dragend', (e) => {
                    e.target.style.opacity = '1';
                    draggedElement = null;
                    draggedStudentId = null;
                    draggedFromStep = null;
                });
            });
        }

        // Add drop event listeners to all drop zones
        function initializeDropZones() {
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    const targetStep = parseInt(zone.getAttribute('data-step'));
                    
                    // Check if drop is valid (only forward one step or backward one step)
                    if (draggedFromStep && (targetStep === draggedFromStep + 1 || targetStep === draggedFromStep - 1)) {
                        zone.style.backgroundColor = '#FEF2F2';
                        zone.style.borderColor = '#d82128';
                        zone.style.borderWidth = '2px';
                        zone.style.borderStyle = 'dashed';
                    } else if (draggedFromStep && targetStep !== draggedFromStep) {
                        zone.style.backgroundColor = '#FEF2F2';
                        zone.style.borderColor = '#d82128';
                        zone.style.borderWidth = '2px';
                        zone.style.borderStyle = 'dashed';
                    }
                });

                zone.addEventListener('dragleave', (e) => {
                    zone.style.backgroundColor = '';
                    zone.style.borderColor = '';
                    zone.style.borderWidth = '';
                    zone.style.borderStyle = '';
                });

                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const targetStep = parseInt(zone.getAttribute('data-step'));
                    
                    // Reset zone styling
                    zone.style.backgroundColor = '';
                    zone.style.borderColor = '';
                    zone.style.borderWidth = '';
                    zone.style.borderStyle = '';
                    
                    // Validate move (only forward one step or backward one step)
                    if (draggedFromStep && (targetStep === draggedFromStep + 1 || targetStep === draggedFromStep - 1)) {
                        // Move the student card
                        if (draggedElement) {
                            // Update the data-step attribute
                            draggedElement.setAttribute('data-step', targetStep);
                            
                            // Remove empty state message if it exists
                            const emptyMessage = zone.querySelector('.text-center.text-gray-400');
                            if (emptyMessage) {
                                emptyMessage.remove();
                            }
                            
                            // Append to new column
                            zone.appendChild(draggedElement);
                            
                            // Update column counts
                            if (typeof updateColumnCounts === 'function') {
                                updateColumnCounts();
                            }
                            
                            // Show success message
                            if (typeof showMoveSuccessToast === 'function') {
                                showMoveSuccessToast(targetStep);
                            }
                            
                            // Here you would typically send the update to your backend
                            console.log(`Moved student ${draggedStudentId} to step ${targetStep}`);
                        }
                    } else {
                        // Show error for invalid move
                        if (typeof showMoveErrorToast === 'function') {
                            showMoveErrorToast();
                        }
                    }
                });
            });
        }

        // Update column counts
        function updateColumnCounts() {
            for (let step = 1; step <= 9; step++) {
                const column = document.querySelector(`[data-step="${step}"]`);
                if (column) {
                    const cards = column.querySelectorAll('[data-student-id]');
                    const countBadge = column.parentElement.parentElement.querySelector('.rounded-full');
                    if (countBadge) {
                        countBadge.textContent = cards.length;
                    }
                    
                    // Add/remove empty state message
                    const existingEmptyMessage = column.querySelector('.text-center.text-gray-400');
                    if (cards.length === 0 && !existingEmptyMessage) {
                        column.innerHTML = '<div class="text-center text-gray-400 text-sm mt-20">No students at this stage</div>';
                    } else if (cards.length > 0 && existingEmptyMessage) {
                        existingEmptyMessage.remove();
                    }
                }
            }
        }

        // Toast notifications for drag and drop
        function showMoveSuccessToast(step) {
            const stepNames = {
                1: 'Initial Advising',
                2: 'Application In Progress',
                3: 'Submitted to School',
                4: 'School Response',
                5: 'Offered Letter Issued',
                6: 'Committed to School',
                7: 'Visa Application',
                8: 'Pre-departure',
                9: 'Arrival'
            };
            showToast(`Student moved to ${stepNames[step]}`);
        }

        function showMoveErrorToast() {
            showToast('Invalid move! Students can only move one step forward or backward.', 'error');
        }

        // Initialize everything
        initializeDragAndDrop();
        initializeDropZones();

        // Add agent filter listener for Kanban view
        const agentFilterSelect = document.getElementById('agent-filter');
        if (agentFilterSelect) {
            agentFilterSelect.addEventListener('change', function() {
                const currentView = document.getElementById('board-view').classList.contains('hidden') ? 'table' : 'board';
                
                if (currentView === 'board') {
                    filterKanbanByAgent(this.value);
                }
            });
        }

        // Activity filter functionality
        const activityFilterSelect = document.getElementById('activity-filter');
        if (activityFilterSelect) {
            activityFilterSelect.addEventListener('change', function() {
                filterByActivity(this.value);
            });
        }

        function filterByActivity(activityStatus) {
            const allStudentRows = document.querySelectorAll('.student-row');
            const allStudentCards = document.querySelectorAll('[data-student-id]');
            
            // Filter table rows
            allStudentRows.forEach(row => {
                const activityBadge = row.querySelector('.bg-green-100, .bg-yellow-100');
                if (activityBadge) {
                    const isActive = activityBadge.textContent.trim().includes('Active');
                    
                    if (activityStatus === 'all') {
                        row.style.display = 'table-row';
                    } else if (activityStatus === 'active' && isActive) {
                        row.style.display = 'table-row';
                    } else if (activityStatus === 'inactive' && !isActive) {
                        row.style.display = 'table-row';
                    } else {
                        row.style.display = 'none';
                    }
                }
            });
            
            // Filter kanban cards
            allStudentCards.forEach(card => {
                const activityBadge = card.querySelector('.bg-green-100, .bg-yellow-100');
                if (activityBadge) {
                    const isActive = activityBadge.textContent.trim().includes('Active');
                    
                    if (activityStatus === 'all') {
                        card.style.display = 'block';
                    } else if (activityStatus === 'active' && isActive) {
                        card.style.display = 'block';
                    } else if (activityStatus === 'inactive' && !isActive) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                }
            });
        }

        // Delete Student Functionality
        function deleteStudent(studentName, studentEmail) {
            // Create and show confirmation modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50';
            modal.innerHTML = `
                <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
                    <div class="mt-3 text-center">
                        <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100">
                            <svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 15.5c-.77.833.192 2.5 1.732 2.5z"></path>
                            </svg>
                        </div>
                        <h3 class="text-lg leading-6 font-medium text-gray-900 mt-4">Delete Student</h3>
                        <div class="mt-2 px-7 py-3">
                            <p class="text-sm text-gray-500 mb-4">
                                Are you sure you want to delete <strong>${studentName}</strong>?
                            </p>
                            <div class="bg-red-50 border border-red-200 rounded-md p-3 mb-4">
                                <p class="text-xs text-red-600">
                                    <strong>Warning:</strong> This action cannot be undone. All student data, documents, and application history will be permanently removed.
                                </p>
                            </div>
                            <div class="text-left bg-gray-50 p-3 rounded-md">
                                <p class="text-xs text-gray-600"><strong>Student:</strong> ${studentName}</p>
                                <p class="text-xs text-gray-600"><strong>Email:</strong> ${studentEmail}</p>
                            </div>
                        </div>
                        <div class="items-center px-4 py-3">
                            <div class="flex space-x-3">
                                <button id="cancel-delete" class="px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md w-full shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-300">
                                    Cancel
                                </button>
                                <button id="confirm-delete" class="px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
                                    Delete Student
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);

            // Handle cancel
            modal.querySelector('#cancel-delete').addEventListener('click', function() {
                document.body.removeChild(modal);
            });

            // Handle confirm delete
            modal.querySelector('#confirm-delete').addEventListener('click', function() {
                // Show loading state
                const confirmBtn = modal.querySelector('#confirm-delete');
                confirmBtn.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Deleting...';
                confirmBtn.disabled = true;

                // Simulate API call delay
                setTimeout(() => {
                    // Remove student from table view
                    const studentRows = document.querySelectorAll('.student-row');
                    studentRows.forEach(row => {
                        const nameElement = row.querySelector('.font-medium');
                        if (nameElement && nameElement.textContent.trim() === studentName) {
                            row.remove();
                        }
                    });

                    // Remove student from kanban view
                    const studentCards = document.querySelectorAll('[data-student-id]');
                    studentCards.forEach(card => {
                        const nameElement = card.querySelector('.font-medium');
                        if (nameElement && nameElement.textContent.trim() === studentName) {
                            card.remove();
                        }
                    });

                    // Update agent group counts
                    updateAgentGroupCounts();
                    updateColumnCounts();

                    // Close modal
                    document.body.removeChild(modal);

                    // Show success message
                    showToast(`Student ${studentName} has been deleted successfully`, 'success');
                }, 1500);
            });

            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
        }

        // Update agent group counts after deletion
        function updateAgentGroupCounts() {
            const agentGroups = document.querySelectorAll('.agent-group-header');
            agentGroups.forEach(group => {
                const agentName = group.querySelector('span').textContent.split(' (')[0];
                const agentClass = agentName.toLowerCase().replace(' ', '-');
                const studentRows = document.querySelectorAll(`.${agentClass}-students`);
                const visibleStudents = Array.from(studentRows).filter(row => row.style.display !== 'none').length;
                
                group.querySelector('span').textContent = `${agentName} (${visibleStudents} student${visibleStudents !== 1 ? 's' : ''})`;
                
                // Hide agent group if no students
                if (visibleStudents === 0) {
                    group.style.display = 'none';
                }
            });
        }

        // Enhanced toast function with different types
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            
            toast.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            // Slide in
            setTimeout(() => {
                toast.classList.remove('translate-x-full');
            }, 100);
            
            // Slide out and remove
            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>
